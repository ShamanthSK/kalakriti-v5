{"ast":null,"code":"import React,{createContext,useContext,useState,useEffect}from'react';import{createUserWithEmailAndPassword,signInWithEmailAndPassword,signOut,onAuthStateChanged,updateProfile}from'firebase/auth';import{doc,setDoc,getDoc}from'firebase/firestore';import{auth,db}from'../firebase/config';import{jsx as _jsx}from\"react/jsx-runtime\";const AuthContext=/*#__PURE__*/createContext();export function useAuth(){return useContext(AuthContext);}export function AuthProvider(_ref){let{children}=_ref;const[currentUser,setCurrentUser]=useState(null);const[loading,setLoading]=useState(true);async function signup(email,password,name){let photo=arguments.length>3&&arguments[3]!==undefined?arguments[3]:null;let category=arguments.length>4&&arguments[4]!==undefined?arguments[4]:'Visual Arts';try{console.log('AuthContext: Starting signup process...');console.log('AuthContext: Email:',email);console.log('AuthContext: Name:',name);console.log('AuthContext: Category:',category);const userCredential=await createUserWithEmailAndPassword(auth,email,password);const user=userCredential.user;console.log('AuthContext: User created successfully:',user.uid);// Update profile with display name\nawait updateProfile(user,{displayName:name,photoURL:photo});console.log('AuthContext: Profile updated successfully');// Create user document in Firestore\nconst userData={name,email,photo:photo||null,primaryCategory:category,talents:[],joinDate:new Date().toISOString(),isOnline:true};console.log('AuthContext: Creating user document in Firestore...');console.log('AuthContext: User data:',userData);await setDoc(doc(db,'users',user.uid),userData);console.log('AuthContext: User document created successfully');return user;}catch(error){console.error('AuthContext: Signup error:',error);console.error('AuthContext: Error code:',error.code);console.error('AuthContext: Error message:',error.message);throw error;}}async function login(email,password){try{const userCredential=await signInWithEmailAndPassword(auth,email,password);return userCredential.user;}catch(error){throw error;}}async function logout(){try{await signOut(auth);}catch(error){throw error;}}async function getUserData(uid){try{const userDoc=await getDoc(doc(db,'users',uid));if(userDoc.exists()){return{id:uid,...userDoc.data()};}return null;}catch(error){console.error('Error fetching user data:',error);return null;}}useEffect(()=>{const unsubscribe=onAuthStateChanged(auth,async user=>{if(user){const userData=await getUserData(user.uid);setCurrentUser(userData);}else{setCurrentUser(null);}setLoading(false);});return unsubscribe;},[]);const value={currentUser,signup,login,logout,getUserData,refreshUserData:async()=>{if(auth.currentUser){const userData=await getUserData(auth.currentUser.uid);setCurrentUser(userData);}}};return/*#__PURE__*/_jsx(AuthContext.Provider,{value:value,children:!loading&&children});}","map":{"version":3,"names":["React","createContext","useContext","useState","useEffect","createUserWithEmailAndPassword","signInWithEmailAndPassword","signOut","onAuthStateChanged","updateProfile","doc","setDoc","getDoc","auth","db","jsx","_jsx","AuthContext","useAuth","AuthProvider","_ref","children","currentUser","setCurrentUser","loading","setLoading","signup","email","password","name","photo","arguments","length","undefined","category","console","log","userCredential","user","uid","displayName","photoURL","userData","primaryCategory","talents","joinDate","Date","toISOString","isOnline","error","code","message","login","logout","getUserData","userDoc","exists","id","data","unsubscribe","value","refreshUserData","Provider"],"sources":["D:/c project/kalakriti2.0/src/contexts/AuthContext.js"],"sourcesContent":["import React, { createContext, useContext, useState, useEffect } from 'react';\nimport { \n  createUserWithEmailAndPassword, \n  signInWithEmailAndPassword, \n  signOut, \n  onAuthStateChanged,\n  updateProfile\n} from 'firebase/auth';\nimport { doc, setDoc, getDoc } from 'firebase/firestore';\nimport { auth, db } from '../firebase/config';\n\nconst AuthContext = createContext();\n\nexport function useAuth() {\n  return useContext(AuthContext);\n}\n\nexport function AuthProvider({ children }) {\n  const [currentUser, setCurrentUser] = useState(null);\n  const [loading, setLoading] = useState(true);\n\n  async function signup(email, password, name, photo = null, category = 'Visual Arts') {\n    try {\n      console.log('AuthContext: Starting signup process...');\n      console.log('AuthContext: Email:', email);\n      console.log('AuthContext: Name:', name);\n      console.log('AuthContext: Category:', category);\n      \n      const userCredential = await createUserWithEmailAndPassword(auth, email, password);\n      const user = userCredential.user;\n      \n      console.log('AuthContext: User created successfully:', user.uid);\n      \n      // Update profile with display name\n      await updateProfile(user, {\n        displayName: name,\n        photoURL: photo\n      });\n      \n      console.log('AuthContext: Profile updated successfully');\n\n      // Create user document in Firestore\n      const userData = {\n        name,\n        email,\n        photo: photo || null,\n        primaryCategory: category,\n        talents: [],\n        joinDate: new Date().toISOString(),\n        isOnline: true\n      };\n      \n      console.log('AuthContext: Creating user document in Firestore...');\n      console.log('AuthContext: User data:', userData);\n      \n      await setDoc(doc(db, 'users', user.uid), userData);\n      \n      console.log('AuthContext: User document created successfully');\n\n      return user;\n    } catch (error) {\n      console.error('AuthContext: Signup error:', error);\n      console.error('AuthContext: Error code:', error.code);\n      console.error('AuthContext: Error message:', error.message);\n      throw error;\n    }\n  }\n\n  async function login(email, password) {\n    try {\n      const userCredential = await signInWithEmailAndPassword(auth, email, password);\n      return userCredential.user;\n    } catch (error) {\n      throw error;\n    }\n  }\n\n  async function logout() {\n    try {\n      await signOut(auth);\n    } catch (error) {\n      throw error;\n    }\n  }\n\n  async function getUserData(uid) {\n    try {\n      const userDoc = await getDoc(doc(db, 'users', uid));\n      if (userDoc.exists()) {\n        return { id: uid, ...userDoc.data() };\n      }\n      return null;\n    } catch (error) {\n      console.error('Error fetching user data:', error);\n      return null;\n    }\n  }\n\n  useEffect(() => {\n    const unsubscribe = onAuthStateChanged(auth, async (user) => {\n      if (user) {\n        const userData = await getUserData(user.uid);\n        setCurrentUser(userData);\n      } else {\n        setCurrentUser(null);\n      }\n      setLoading(false);\n    });\n\n    return unsubscribe;\n  }, []);\n\n  const value = {\n    currentUser,\n    signup,\n    login,\n    logout,\n    getUserData,\n    refreshUserData: async () => {\n      if (auth.currentUser) {\n        const userData = await getUserData(auth.currentUser.uid);\n        setCurrentUser(userData);\n      }\n    }\n  };\n\n  return (\n    <AuthContext.Provider value={value}>\n      {!loading && children}\n    </AuthContext.Provider>\n  );\n} "],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,aAAa,CAAEC,UAAU,CAAEC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAC7E,OACEC,8BAA8B,CAC9BC,0BAA0B,CAC1BC,OAAO,CACPC,kBAAkB,CAClBC,aAAa,KACR,eAAe,CACtB,OAASC,GAAG,CAAEC,MAAM,CAAEC,MAAM,KAAQ,oBAAoB,CACxD,OAASC,IAAI,CAAEC,EAAE,KAAQ,oBAAoB,CAAC,OAAAC,GAAA,IAAAC,IAAA,yBAE9C,KAAM,CAAAC,WAAW,cAAGhB,aAAa,CAAC,CAAC,CAEnC,MAAO,SAAS,CAAAiB,OAAOA,CAAA,CAAG,CACxB,MAAO,CAAAhB,UAAU,CAACe,WAAW,CAAC,CAChC,CAEA,MAAO,SAAS,CAAAE,YAAYA,CAAAC,IAAA,CAAe,IAAd,CAAEC,QAAS,CAAC,CAAAD,IAAA,CACvC,KAAM,CAACE,WAAW,CAAEC,cAAc,CAAC,CAAGpB,QAAQ,CAAC,IAAI,CAAC,CACpD,KAAM,CAACqB,OAAO,CAAEC,UAAU,CAAC,CAAGtB,QAAQ,CAAC,IAAI,CAAC,CAE5C,cAAe,CAAAuB,MAAMA,CAACC,KAAK,CAAEC,QAAQ,CAAEC,IAAI,CAA0C,IAAxC,CAAAC,KAAK,CAAAC,SAAA,CAAAC,MAAA,IAAAD,SAAA,MAAAE,SAAA,CAAAF,SAAA,IAAG,IAAI,IAAE,CAAAG,QAAQ,CAAAH,SAAA,CAAAC,MAAA,IAAAD,SAAA,MAAAE,SAAA,CAAAF,SAAA,IAAG,aAAa,CACjF,GAAI,CACFI,OAAO,CAACC,GAAG,CAAC,yCAAyC,CAAC,CACtDD,OAAO,CAACC,GAAG,CAAC,qBAAqB,CAAET,KAAK,CAAC,CACzCQ,OAAO,CAACC,GAAG,CAAC,oBAAoB,CAAEP,IAAI,CAAC,CACvCM,OAAO,CAACC,GAAG,CAAC,wBAAwB,CAAEF,QAAQ,CAAC,CAE/C,KAAM,CAAAG,cAAc,CAAG,KAAM,CAAAhC,8BAA8B,CAACQ,IAAI,CAAEc,KAAK,CAAEC,QAAQ,CAAC,CAClF,KAAM,CAAAU,IAAI,CAAGD,cAAc,CAACC,IAAI,CAEhCH,OAAO,CAACC,GAAG,CAAC,yCAAyC,CAAEE,IAAI,CAACC,GAAG,CAAC,CAEhE;AACA,KAAM,CAAA9B,aAAa,CAAC6B,IAAI,CAAE,CACxBE,WAAW,CAAEX,IAAI,CACjBY,QAAQ,CAAEX,KACZ,CAAC,CAAC,CAEFK,OAAO,CAACC,GAAG,CAAC,2CAA2C,CAAC,CAExD;AACA,KAAM,CAAAM,QAAQ,CAAG,CACfb,IAAI,CACJF,KAAK,CACLG,KAAK,CAAEA,KAAK,EAAI,IAAI,CACpBa,eAAe,CAAET,QAAQ,CACzBU,OAAO,CAAE,EAAE,CACXC,QAAQ,CAAE,GAAI,CAAAC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC,CAClCC,QAAQ,CAAE,IACZ,CAAC,CAEDb,OAAO,CAACC,GAAG,CAAC,qDAAqD,CAAC,CAClED,OAAO,CAACC,GAAG,CAAC,yBAAyB,CAAEM,QAAQ,CAAC,CAEhD,KAAM,CAAA/B,MAAM,CAACD,GAAG,CAACI,EAAE,CAAE,OAAO,CAAEwB,IAAI,CAACC,GAAG,CAAC,CAAEG,QAAQ,CAAC,CAElDP,OAAO,CAACC,GAAG,CAAC,iDAAiD,CAAC,CAE9D,MAAO,CAAAE,IAAI,CACb,CAAE,MAAOW,KAAK,CAAE,CACdd,OAAO,CAACc,KAAK,CAAC,4BAA4B,CAAEA,KAAK,CAAC,CAClDd,OAAO,CAACc,KAAK,CAAC,0BAA0B,CAAEA,KAAK,CAACC,IAAI,CAAC,CACrDf,OAAO,CAACc,KAAK,CAAC,6BAA6B,CAAEA,KAAK,CAACE,OAAO,CAAC,CAC3D,KAAM,CAAAF,KAAK,CACb,CACF,CAEA,cAAe,CAAAG,KAAKA,CAACzB,KAAK,CAAEC,QAAQ,CAAE,CACpC,GAAI,CACF,KAAM,CAAAS,cAAc,CAAG,KAAM,CAAA/B,0BAA0B,CAACO,IAAI,CAAEc,KAAK,CAAEC,QAAQ,CAAC,CAC9E,MAAO,CAAAS,cAAc,CAACC,IAAI,CAC5B,CAAE,MAAOW,KAAK,CAAE,CACd,KAAM,CAAAA,KAAK,CACb,CACF,CAEA,cAAe,CAAAI,MAAMA,CAAA,CAAG,CACtB,GAAI,CACF,KAAM,CAAA9C,OAAO,CAACM,IAAI,CAAC,CACrB,CAAE,MAAOoC,KAAK,CAAE,CACd,KAAM,CAAAA,KAAK,CACb,CACF,CAEA,cAAe,CAAAK,WAAWA,CAACf,GAAG,CAAE,CAC9B,GAAI,CACF,KAAM,CAAAgB,OAAO,CAAG,KAAM,CAAA3C,MAAM,CAACF,GAAG,CAACI,EAAE,CAAE,OAAO,CAAEyB,GAAG,CAAC,CAAC,CACnD,GAAIgB,OAAO,CAACC,MAAM,CAAC,CAAC,CAAE,CACpB,MAAO,CAAEC,EAAE,CAAElB,GAAG,CAAE,GAAGgB,OAAO,CAACG,IAAI,CAAC,CAAE,CAAC,CACvC,CACA,MAAO,KAAI,CACb,CAAE,MAAOT,KAAK,CAAE,CACdd,OAAO,CAACc,KAAK,CAAC,2BAA2B,CAAEA,KAAK,CAAC,CACjD,MAAO,KAAI,CACb,CACF,CAEA7C,SAAS,CAAC,IAAM,CACd,KAAM,CAAAuD,WAAW,CAAGnD,kBAAkB,CAACK,IAAI,CAAE,KAAO,CAAAyB,IAAI,EAAK,CAC3D,GAAIA,IAAI,CAAE,CACR,KAAM,CAAAI,QAAQ,CAAG,KAAM,CAAAY,WAAW,CAAChB,IAAI,CAACC,GAAG,CAAC,CAC5ChB,cAAc,CAACmB,QAAQ,CAAC,CAC1B,CAAC,IAAM,CACLnB,cAAc,CAAC,IAAI,CAAC,CACtB,CACAE,UAAU,CAAC,KAAK,CAAC,CACnB,CAAC,CAAC,CAEF,MAAO,CAAAkC,WAAW,CACpB,CAAC,CAAE,EAAE,CAAC,CAEN,KAAM,CAAAC,KAAK,CAAG,CACZtC,WAAW,CACXI,MAAM,CACN0B,KAAK,CACLC,MAAM,CACNC,WAAW,CACXO,eAAe,CAAE,KAAAA,CAAA,GAAY,CAC3B,GAAIhD,IAAI,CAACS,WAAW,CAAE,CACpB,KAAM,CAAAoB,QAAQ,CAAG,KAAM,CAAAY,WAAW,CAACzC,IAAI,CAACS,WAAW,CAACiB,GAAG,CAAC,CACxDhB,cAAc,CAACmB,QAAQ,CAAC,CAC1B,CACF,CACF,CAAC,CAED,mBACE1B,IAAA,CAACC,WAAW,CAAC6C,QAAQ,EAACF,KAAK,CAAEA,KAAM,CAAAvC,QAAA,CAChC,CAACG,OAAO,EAAIH,QAAQ,CACD,CAAC,CAE3B","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}